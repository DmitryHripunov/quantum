import{d as b,r as n,o as y,a as S,b as k,c as x,e as s,t as l,F as E,_ as L}from"./index-9r4lQWdE.js";const N={class:"level mr"},C={class:"energy mr"},J="wss://ws.quantumcats.io/play",O=b({__name:"HomeView",setup(W){const v=n(0),c=n(0),r=n(0),i=n(0),u=n(0),p=n(0),d=n(0),m=n(0),f=n(null),o=n(null),w=()=>{let e=null;return e&&(e.onerror=e.onopen=e.onclose=null,e.close()),e=new WebSocket(`${J}`),e.addEventListener("error",()=>{console.log("WebSocket error"),e=null}),e.addEventListener("open",()=>{console.log("WebSocket connection established"),e.send(JSON.stringify({action:"login",name:"power",user_id:1})),e.send(JSON.stringify({action:"me"})),e.send(JSON.stringify({action:"showcase"}))}),e.addEventListener("close",()=>{console.log("WebSocket connection closed"),e=null}),e},_=()=>{o.value=w(),o.value.addEventListener("message",async e=>{let t;try{t=await JSON.parse(e.data)}catch(a){console.log(a);return}if(t.action==="me"&&(v.value=t.data.bal,c.value=t.data.level.current,r.value=t.data.power.current,i.value=t.data.power.max,u.value=t.data.tap.current,p.value=t.data.level.next_level_value),t.action==="showcase")for(const a of t.data)a.name=="tap"&&(d.value=a.next.cost),a.name=="speed"&&(d.value=a.next.cost,m.value=a.current),a.name=="power"&&(f.value=a.next.cost)})},g=()=>{o.value&&o.value.send(JSON.stringify({action:"tap"}))};return y(()=>{_()}),S(()=>{o.value=null}),(e,t)=>(k(),x(E,null,[s("div",N,"Level #"+l(c.value),1),t[1]||(t[1]=s("div",{class:"tap-progress mr"},null,-1)),s("div",{class:"tap mr",onClick:t[0]||(t[0]=a=>g())},l(u.value),1),s("div",C,"Energy: "+l(r.value)+" / "+l(i.value),1)],64))}}),B=L(O,[["__scopeId","data-v-ab4130e5"]]);export{B as default};
