import{d as y,r as a,o as S,a as b,b as k,c as x,e as s,t as l,F as E,_ as L}from"./index-UCDdDJNo.js";const N={class:"level mr"},C={class:"energy mr"},J="wss://ws.quantumcats.io/play",O=y({__name:"MainView",setup(W){const v=a(0),c=a(0),r=a(0),i=a(0),u=a(0),p=a(0),d=a(0),m=a(0),f=a(null),o=a(null),w=()=>{let e=null;return e&&(e.onerror=e.onopen=e.onclose=null,e.close()),e=new WebSocket(`${J}`),e.addEventListener("error",()=>{console.log("WebSocket error"),e=null}),e.addEventListener("open",()=>{console.log("WebSocket connection established"),e.send(JSON.stringify({action:"login",name:"power",user_id:1})),e.send(JSON.stringify({action:"me"})),e.send(JSON.stringify({action:"showcase"}))}),e.addEventListener("close",()=>{console.log("WebSocket connection closed"),e=null}),e},_=()=>{o.value=w(),o.value.addEventListener("message",async e=>{let n;try{n=await JSON.parse(e.data)}catch(t){console.log(t);return}if(n.action==="me"&&(v.value=n.data.bal,c.value=n.data.level.current,r.value=n.data.power.current,i.value=n.data.power.max,u.value=n.data.tap.current,p.value=n.data.level.next_level_value),n.action==="showcase")for(const t of n.data)t.name=="tap"&&(d.value=t.next.cost),t.name=="speed"&&(d.value=t.next.cost,m.value=t.current),t.name=="power"&&(f.value=t.next.cost)})},g=()=>{o.value&&o.value.send(JSON.stringify({action:"tap"}))};return S(()=>{_()}),b(()=>{o.value=null}),(e,n)=>(k(),x(E,null,[s("div",N,"Level #"+l(c.value),1),n[1]||(n[1]=s("div",{class:"tap-progress mr"},null,-1)),s("div",{class:"tap mr",onClick:n[0]||(n[0]=t=>g())},l(u.value),1),s("div",C,"Energy: "+l(r.value)+" / "+l(i.value),1)],64))}}),h=L(O,[["__scopeId","data-v-d6c10c82"]]);export{h as default};
